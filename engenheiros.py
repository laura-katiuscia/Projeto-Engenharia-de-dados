# -*- coding: utf-8 -*-
"""Engenheiros

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/1VUUiypfnl_nwkdxi_dLwXmv6VA5zlVfz
"""

# O Cen√°rio: Processando um JSON de Vendas (Os dados v√™m como uma lista de dicion√°rios.)

# Dados brutos (Ingest√£o)
vendas_brutas = [
    {"id": 1, "produto": "Mouse", "preco": 50.0, "qtd": 2},
    {"id": 2, "produto": "Teclado", "preco": 150.0, "qtd": 1},
    {"id": 3, "produto": "Monitor", "preco": 900.0, "qtd": 0}, # Venda inv√°lida?
    {"id": 4, "produto": "Cadeira", "preco": 599.0, "qtd": 3},
    {"id": 3, "produto": "Monitor", "preco": 900.0, "qtd": 0}, # Venda inv√°lida?
    {"id": 4, "produto": "Cadeira", "preco": 599.0, "qtd": 4 }
]

# Como engenheiro, sua primeira tarefa pode ser filtrar apenas vendas v√°lidas (quantidade > 0).
# Para isso 1¬∫ Passo Transforma√ß√£o com Listas (Filtering)

# Usando "List Comprehension" para filtrar
vendas_validas = [item for item in vendas_brutas if item["qtd"] > 0]
print ( vendas_validas)

#Fazendo BASH comando linux, atuando como interface entre o usu√°rio e o sistema operacional
# Principais comandos ls: Lista arquivos e pastas do diret√≥rio atual. cd: Navega entre diret√≥rios.
# pwd: Exibe o diret√≥rio de trabalho atual. mv: Move ou renomeia arquivos/pastas.
# cp: Copia arquivos/pastas. rm: Remove arquivos/pastas. mkdir: Cria um novo diret√≥rio.
# grep: Pesquisa textos dentro de arquivos. echo: Exibe uma linha de texto.
# sudo: Executa comandos com privil√©gios de superusu√°rio.

!git config --global user.name "Laura katiuscia"
!git config --global user.email "laura.katiusc@gmail.com"

!git clone https://github.com/laura-katiuscia/Projeto-Engenharia-de-dados.git

!mv Engenheiros.py
#

import os
from getpass import getpass

# 1. Configura√ß√µes do Usu√°rio
username = "https://github.com/laura-katiuscia" # Coloque seu usu√°rio aqui
email = "laura.katiusc@gmail.com" # Coloque seu email aqui
repo_name = "Engenheiro de dados" # O nome exato do reposit√≥rio
arquivo_para_subir = "Pedidos.csv" # O arquivo que voc√™ quer enviar

# 2. Solicita o Token de forma segura (cole o token gerado no passo 1 quando pedir)
password = getpass('Cole seu Personal Access Token aqui: ')

# 3. Configura o Git globalmente na m√°quina virtual
!git config --global user.email "$laura.katiusc@gmail.com"
!git config --global user.name "$Laura-Katiuscia"



vari = [item for item in vendas_brutas if item["qtd"] < 3]  # Fazer esse desafio
print(vari)  # Quantas vendas n√£o s√£o v√°lidas

qtd_zeros = len([v for v in vendas_brutas if v['qtd'] == 0])
print(f"M√©todo Curto: Foram encontradas {qtd_zeros} vendas com quantidade zero.")

# 2 Passo. Enriquecimento com Dicion√°rios (Mapping)
# Agora, voc√™ precisa calcular o valor total de cada venda e adicionar essa nova informa√ß√£o.

for venda in vendas_validas:
    # Criando uma nova chave no dicion√°rio (Enriquecimento)
    venda["total_faturado"] = venda["preco"] * venda["qtd"]

    # Removendo dados sens√≠veis ou desnecess√°rios
    venda.pop("id", None) # Usamos .pop() para evitar KeyError se 'id' j√° tiver sido removido
    print(venda)

    # Dicion√°rios: S√£o perfeitos para linha de uma tabela, Listas: Registros processamos lotes (batches
    # Na vida real, quando o volume cresce, o engenheiro de dados converte essa lista de dicion√°rios em um DataFrame (Pandas ou PySpark).

# m√°gica da Engenharia de Dados acontece: sai de um formato flex√≠vel (JSON/Dicion√°rios)
# para um formato de alta performance (Tabelas/DataFrames).
# Pandas √© a biblioteca que faz essa ponte. Ele pega sua lista de dicion√°rios e a organiza em colunas,
# permitindo que voc√™ trate os dados como
# se estivesse em um SQL ou Excel potente.

# De Dicion√°rios para DataFrame
import pandas as pd

# 1. Nossa lista de dicion√°rios (os dados que vieram da API)
dados_vendas = [
    {"produto": "Mouse", "preco": 50.0, "qtd": 2},
    {"produto": "Teclado", "preco": 150.0, "qtd": 1},
    {"produto": "Monitor", "preco": 900.0, "qtd": 5},
    {"produto": "Monitor", "preco": 900.0, "qtd": 3},
    {"produto": "Monitor", "preco": 900.0, "qtd": 10}
]

# 2. Transformando para DataFrame (Tabela)
df = pd.DataFrame(dados_vendas)

# 3. Criando uma nova coluna de forma perform√°tica (estilo Vetor/Matriz)
df['total'] = df['preco'] * df['qtd']
df['teste'] = df['preco'] - df['qtd']

print(df)

# Desafio aceito! Na vida real, os dados de engenharia raramente v√™m "limpinhos".
# Muitas vezes, eles v√™m em dicion√°rios aninhados (um dicion√°rio dentro de outro, dentro de uma lista).

# Imagine que voc√™ recebeu os dados de um sensor de temperatura de uma f√°brica. O formato √© este:
dados_sensor = {
    "fabrica": "Unidade Sul",  "sensores": [
        {"id": "S1", "leitura": {"valor": 25.5, "unidade": "C"}},
        {"id": "S2", "leitura": {"valor": 30.2, "unidade": "C"}},
        {"id": "S3", "leitura": {"valor": 22.8, "unidade": "C"}},
        {"id": "S4", "leitura": {"valor": 29.5, "unidade": "C"}},
        {"id": "S5", "leitura": {"valor": 32.2, "unidade": "C"}},
        {"id": "S6", "leitura": {"valor": 22.10, "unidade": "C"}}
    ]
}
print(dados_sensor)

# Para acessar e imprimir o valor da leitura (30.2) do segundo sensor (S2),
# conforme o desafio em '0kKoQvgfP0sq', navegue o dicion√°rio 'dados_sensor'.

# O seu objetivo: Como voc√™ faria para acessar e imprimir apenas o valor da leitura (o n√∫mero 30.2) do segundo sensor (S2)?
# Dica de Engenheiro: 1. Primeiro, acesse a chave "sensores". 2. Lembre-se que o

# que est√° dentro de "sensores" √© uma lista (use colchetes [] e o √≠ndice come√ßando em 0).
#  3. Depois, v√° entrando nas chaves do dicion√°rio interno. Como ficaria o seu c√≥digo para chegar nesse 30.2?

# Quando voc√™ conseguir acessar esse valor, ter√° dominado a l√≥gica fundamental de como os dados trafegam na internet.
# Dica final antes de ir: No Python, voc√™ vai "empilhando" os acessos, algo como: dados_sensor['chave'][indice]['outra_chave']...

valor_sensor_s2 = dados_sensor['sensores'][1]['leitura']['valor'] # Anatomia do seu Acesso
print(f"O valor da leitura do segundo sensor (S2) √©: {valor_sensor_s2}")  # ['sensores']: Acessa a lista principal de sensores.

                                                                  # 1 √© posi√ß√£o e ['leitura']: Entra no dicion√°rio de dados daquele sensor espec√≠fico.
                                                                  # ['valor']: Captura finalmente o dado num√©rico que voc√™ buscava.

# O dicion√°rio de exemplo
dados_sensor = {
    "sensores": [
        {"id": "S1", "leitura": {"valor": 25.5}},
        {"id": "S2", "leitura": {"valor": 30.2}},
        {"id": "S3", "leitura": {"valor": 18.9}}
    ]
}

# Buscando o sensor pelo ID de forma segura
valor_encontrado = None

for sensor in dados_sensor['sensores']:
    if sensor['id'] == 'S2':
        valor_encontrado = sensor['leitura']['valor']
        break  # Encontrou? Para de procurar para poupar processamento!

if valor_encontrado is not None:
    print(f"Sucesso! O valor do S2 √©: {valor_encontrado}")
else:
    print("Sensor n√£o encontrado.")

import pandas as pa

novo = pa.read_csv('Pedidos.csv', sep=';')
print(novo)

#Primeiras linhas

novo.head()

#Linhas aleat√≥rias (Cada clique ele mostra uma linha aleat√≥ria)

novo.sample()

## Ver registros mais recentes (ex: √∫ltimos dias de vendas)
# E identiica se tiver valores estranhos no final do dataset
# conferir se nada quebrou no final do dataset üòâ

novo.tail()

#Quantidade de linhas e colunas que tem dataset

novo.shape

#V√™ se tem alguma linha duplicada com linha id√™ntica a outra em TODAS as colunas
novo.duplicated().sum()

#üîç Como ver essa linha duplicada

novo[novo.duplicated()] # aqui mostra somente linha 1 e duplicada de 0, j√° linha de comando abaixo mostra as 2 linhas
novo[novo.duplicated(keep=False)]

#üßπ Como remover duplicatas (se fizer sentido)

novo = novo.drop_duplicates()

novo.head()

# an√°lise explorat√≥ria de dados üëÄüìä resumo estat√≠stico completo
# üî§ Para colunas categ√≥ricas (texto) Voc√™ ver√°:

# count ‚Üí valores n√£o nulos (Ver se existem categorias repetidas demais
# Encontrar valores fora do esperado, Ter uma vis√£o geral antes de modelar)

# unique ‚Üí quantos valores diferentes
# top ‚Üí valor mais frequente
# freq ‚Üí quantas vezes ele aparece

novo.describe(include='all')

# üí° Resumo: groupby = ‚Äúsepara os dados em grupos e calcula algo para cada grupo‚Äù
# Esse atividade n√£o usei devido n√£o ter necessidade de calculos, mas uso select

novo[['Data Pedido','Prioridade Pedido']]

# Usando SELECT COM WHERE
novo[novo['Prioridade Pedido'] == 'Critico']

#
novo['Prioridade Pedido'].value_counts()

# Ideal para an√°lise explorat√≥ria (EDA).
import matplotlib.pyplot as plt

# Padroniza os textos (boa pr√°tica)
prioridades = (
    novo['Prioridade Pedido']
    .str.strip()
    .str.capitalize()
)

# Conta quantos pedidos por prioridade
contagem = prioridades.value_counts()

# Cria o gr√°fico
contagem.plot(kind='bar')

plt.title('Distribui√ß√£o de Prioridade dos Pedidos')
plt.xlabel('Prioridade do Pedido')
plt.ylabel('Quantidade de Pedidos')

plt.show()